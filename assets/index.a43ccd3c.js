import{d as l,n as h}from"./create.03b31fc7.js";import"./index.5d3634b8.js";import{t as n,g as c,a as o}from"./elements.2a324d45.js";import{c as f}from"./zIndex.bcf143f4.js";import{c as m}from"./teleport.cb83deae.js";import{N as r}from"./shared.f8da68a0.js";import"./index.19abdf8c.js";import{T as d}from"./Teleport.f02619e5.js";function p(t){return["top","bottom"].includes(t)}const u={show:{type:Boolean,default:!1},alignment:{type:String,default:"top",validator:p},offsetX:{type:[Number,String],default:0},offsetY:{type:[Number,String],default:0},teleport:{type:String,default:"body"}};var i=l({name:"VarMenu",mixins:[f("show",1),m],props:u,data:()=>({to:null,top:0,left:0,clickSelf:!1}),computed:{transitionStyle(){return{top:`calc(${this.top}px + ${n(this.offsetY)})`,left:`calc(${this.left}px + ${n(this.offsetX)})`,zIndex:this.zIndex}}},mounted(){this.to=this.teleport,this.resize(),document.addEventListener("click",this.handleMenuClose),window.addEventListener("resize",this.resize)},beforeDestroy(){document.removeEventListener("click",this.handleMenuClose),window.removeEventListener("resize",this.resize)},watch:{alignment(){this.resize()},async show(t){const{onOpen:e,onClose:s}=this.getListeners();t&&(await h(),this.resize()),t?e==null||e():s==null||s()},teleport(t){this.to=t}},methods:{resize(){this.top=this.computeTop(this.alignment),this.left=c(this.$refs.host)},computeTop(t){const{host:e,menu:s}=this.$refs;return t==="top"?o(e):o(e)-s.offsetHeight},handleClick(){this.clickSelf=!0},handleMenuClose(){var t,e;if(this.clickSelf){this.clickSelf=!1;return}!this.show||(e=(t=this.getListeners())["onUpdate:show"])==null||e.call(t)},renderTransition(){var e,s;const t=this.$createElement;return t("transition",{attrs:{name:"var-menu"},on:{afterEnter:(e=this.getListeners().onOpened)!=null?e:r,afterLeave:(s=this.getListeners().onClosed)!=null?s:r}},[t("div",{class:"var-menu__menu var-elevation--3",ref:"menu",style:this.transitionStyle,directives:[{name:"show",value:this.show}],on:{click:a=>{a.stopPropagation()}}},[this.slots("menu")])])}},render(){const t=arguments[0];return t("div",{class:"var-menu",ref:"host",on:{click:this.handleClick}},[this.slots("default"),this.to?t(d,{attrs:{to:this.to,disabled:this.teleportDisabled}},[this.renderTransition()]):this.renderTransition()])}});i.install=function(t){t.component(i.name,i)};export{i as M};
